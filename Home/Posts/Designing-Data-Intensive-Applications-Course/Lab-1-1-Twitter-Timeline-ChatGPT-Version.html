<html><head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LEEFT9748K"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-LEEFT9748K');
</script>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans&display=swap" rel="stylesheet">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Lab 1.1 Twitter Timeline ChatGPT Version</title><style>

body, h1, h2, h3, a, p {
	font-family: 'DM Sans', sans-serif;
	letter-spacing: .02em;
	font-size: 1.2rem;
}

/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-translucentGray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg-width%3D%2216%22-height%3D%2216%22-viewBox%3D%220-0-16-16%22-fill%3D%22none%22-xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect-width%3D%2216%22-height%3D%2216%22-fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath-d%3D%22M6.71429-12.2852L14-4.9995L12.7143-3.71436L6.71429-9.71378L3.28571-6.2831L2-7.57092L6.71429-12.2852Z%22-fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg-width%3D%2216%22-height%3D%2216%22-viewBox%3D%220-0-16-16%22-fill%3D%22none%22-xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect-x%3D%220.75%22-y%3D%220.75%22-width%3D%2214.5%22-height%3D%2214.5%22-fill%3D%22white%22-stroke%3D%22%2336352F%22-stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	

@media (max-width: 575.98px) {
	body {
		padding-left: 1rem;
		padding-right: 1rem;
		font-size: 2.0rem;
	}
	a {
		font-size: 2.0rem;
	}
	h1 {
		font-size: Fsrem;
	}
	h2 {
		font-size: 2.0rem;
	}
	h3 {
		font-size: 2.0rem;
	}
    p {
        font-size: 2.0rem;
    }
	img {
   		max-width: 90%;
  	  	min-width: 36px;
 	   	height: auto;
	}
}


@media (max-width: 767.98px) {
	body {
		padding-left: 1rem;
		padding-right: 1rem;
		font-size: 1.8rem;
	}
	a {
		font-size: 1.8rem;
	}
	h1 {
		font-size: Fsrem;
	}
	h2 {
		font-size: 1.8rem;
	}
	h3 {
		font-size: 1.8rem;
	}
    p {
        font-size: 1.8rem;
    }
	img {
   		max-width: 90%;
  	  	min-width: 36px;
 	   	height: auto;
	}
}


@media (max-width: 991.98px) {
	body {
		padding-left: 1rem;
		padding-right: 1rem;
		font-size: 1.7rem;
	}
	a {
		font-size: 1.7rem;
	}
	h1 {
		font-size: Fsrem;
	}
	h2 {
		font-size: 1.7rem;
	}
	h3 {
		font-size: 1.7rem;
	}
    p {
        font-size: 1.7rem;
    }
	img {
   		max-width: 90%;
  	  	min-width: 36px;
 	   	height: auto;
	}
}


@media (max-width: 1199.98px) {
	body {
		padding-left: 1rem;
		padding-right: 1rem;
		font-size: 1.6rem;
	}
	a {
		font-size: 1.6rem;
	}
	h1 {
		font-size: Fsrem;
	}
	h2 {
		font-size: 1.6rem;
	}
	h3 {
		font-size: 1.6rem;
	}
    p {
        font-size: 1.6rem;
    }
	img {
   		max-width: 90%;
  	  	min-width: 36px;
 	   	height: auto;
	}
}


@media (max-width: 1399.98px) {
	body {
		padding-left: 1rem;
		padding-right: 1rem;
		font-size: 1.4rem;
	}
	a {
		font-size: 1.4rem;
	}
	h1 {
		font-size: Fsrem;
	}
	h2 {
		font-size: 1.4rem;
	}
	h3 {
		font-size: 1.4rem;
	}
    p {
        font-size: 1.4rem;
    }
	img {
   		max-width: 90%;
  	  	min-width: 36px;
 	   	height: auto;
	}
}
</style></head><body><article id="7a7e6948-43d8-478c-be1c-506683cfbf49" class="page sans"><header><h1 class="page-title">Lab 1.1 Twitter Timeline ChatGPT Version</h1></header><div class="page-body"><div><p id="d623529e-b42e-4f3e-9faf-93b865c175cc" class="">Data Al Dente</p><p id="7f8dacda-5257-4c3b-86df-a683e1b85c55" class=""><a href="../../../index.html">Home</a> | <a href="../../Posts.html">Posts</a> | <a href="../../About-Me.html">About Me</a></p></div><p id="e52f6d6d-6126-47ac-8db7-74c994ed7ce8" class="">Created <time>@April 20, 2023</time> </p><p id="9a9aa316-a87b-47de-b394-c59db82f8a11" class="">Updated <time>@April 20, 2023</time> </p><ul id="3ce0bc4e-a961-444e-a1e3-c996d07d1d26" class="toggle"><li><details><summary style="cursor: pointer">Outline</summary><nav id="d075d589-fdde-4dc7-8d1e-5c5a18697ac0" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#31045860-81f9-4401-9e78-b7f8d285775c">Prompt</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#8a7f0b49-1301-46a5-ba56-40dc07379aad">Output</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#4532402e-5e41-428b-b455-28b3437865d6">Part 1: Setting up the data model</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#00e409ab-f115-4044-ad0b-c09a652497a8">Part 2: Simulating the fan-out-on-write approach</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#adafa996-7c12-448c-a999-4accc4ecea70">Part 3: Handling scalability challenges</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#9bcd9f4f-0b9d-4ba9-aba5-7afe77e5698b">Conclusion</a></div></nav></details></li></ul><p id="5297da0f-9d2c-4b7a-bb76-8f18ed0582df" class="">I thought it would be interesting to compare what ChatGPT comes up with in a few minutes vs what I did with quite a few hours of work. Below is the prompt and output.</p><h1 id="31045860-81f9-4401-9e78-b7f8d285775c" class="">Prompt</h1><p id="991a78b0-ee33-4e6c-bd49-de1818c817ec" class="">You are a software engineer creating a supplemental course to the book Designing Data-Intensive Applications with the goal of enabling those who want to deeply understand the book to do so in a way that essentially guarantees that they can really internalize and apply the ideas from it. This course will go into more detail on how to use real-life systems than the book and will have more on interactive/hands-on exercises/labs.</p><p id="3ab2076b-ba34-47ef-aa6a-f66e79b980e5" class="">Write a blog post which is an interactive lab using the twitter timeline example from the Scalability section of chapter 1 from the book. The blog post should be between 3000 and 6000 words long and should contain exercises and questions with solutions for the user along with runnable code examples.</p><h1 id="8a7f0b49-1301-46a5-ba56-40dc07379aad" class="">Output</h1><p id="56cffb23-a177-4830-9cad-5eca64f3dffe" class="">Welcome to this interactive lab designed to deepen your understanding of the scalability concepts presented in the book &quot;Designing Data-Intensive Applications&quot; by Martin Kleppmann. In this lab, we will explore the Twitter timeline example from Chapter 1 and dive deeper into how the system can scale and handle large amounts of data.</p><p id="7a4de36e-b38d-4322-b5d0-d2f25adab310" class="">First, let&#x27;s recap the Twitter timeline example from the book. In Twitter, when a user posts a tweet, the tweet is broadcast to all of the user&#x27;s followers. Each follower&#x27;s timeline must be updated with the new tweet. To achieve this, Twitter uses a fan-out-on-write approach, where each write to the database results in a fan-out to all of the user&#x27;s followers.</p><p id="4acfd584-8541-432f-8702-839872421319" class="">Let&#x27;s dive deeper into this example and explore how the system can handle scalability challenges. We will use Python and Redis for this lab. If you haven&#x27;t already, please make sure you have Redis installed and running on your machine.</p><h2 id="4532402e-5e41-428b-b455-28b3437865d6" class="">Part 1: Setting up the data model</h2><p id="06da744f-fcd4-4cbd-8aea-37df18f1f3a8" class="">Before we begin, let&#x27;s start by setting up our data model. We will create a simple data model using Redis that will allow us to simulate the Twitter timeline example.</p><pre id="2af23d9a-ebb4-431a-8e89-adfea87aff48" class="code code-wrap"style="overflow-x:auto;"><code>import redis

# Connect to Redis
r = redis.Redis(host=&#x27;localhost&#x27;, port=6379, db=0)

# Define a function to create users
def create_user(user_id):
    r.sadd(&#x27;users&#x27;, user_id)

# Define a function to create a tweet
def create_tweet(tweet_id, user_id, tweet_text):
    r.hmset(f&#x27;tweet:{tweet_id}&#x27;, {&#x27;text&#x27;: tweet_text, &#x27;user_id&#x27;: user_id})

    # Add the tweet to the user&#x27;s timeline
    r.lpush(f&#x27;user_timeline:{user_id}&#x27;, tweet_id)

    # Add the tweet to the public timeline
    r.lpush(&#x27;public_timeline&#x27;, tweet_id)
</code></pre><p id="6cc59f80-c153-4dd2-8e37-a8a5df68dc0f" class="">Here, we define two functions: <code>create_user</code> and <code>create_tweet</code>. <code>create_user</code> takes a user ID and adds it to a Redis set called <code>users</code>. <code>create_tweet</code> takes a tweet ID, user ID, and tweet text and does the following:</p><ol type="1" id="ed2b3eee-2058-46d8-a5e9-d7977c3d2279" class="numbered-list" start="1"><li>Stores the tweet in a Redis hash with the key <code>tweet:&lt;tweet_id&gt;</code>.</li></ol><ol type="1" id="1d3ef5c8-0fe5-4356-90d1-8f19428c022f" class="numbered-list" start="2"><li>Adds the tweet ID to the user&#x27;s timeline using the Redis list command <code>lpush</code>.</li></ol><ol type="1" id="b5a29ed8-2014-4963-bcf0-ccdd5f7474a6" class="numbered-list" start="3"><li>Adds the tweet ID to the public timeline using <code>lpush</code>.</li></ol><p id="f77189d1-6575-48c5-8fe9-64407576b444" class="">Now, let&#x27;s create some users and tweets to populate our data model:</p><pre id="33ea99ec-90bc-45ca-8c17-65d3f8cbbe3c" class="code code-wrap"style="overflow-x:auto;"><code># Create some users
create_user(&#x27;alice&#x27;)
create_user(&#x27;bob&#x27;)
create_user(&#x27;charlie&#x27;)

# Create some tweets
create_tweet(1, &#x27;alice&#x27;, &#x27;Hello world!&#x27;)
create_tweet(2, &#x27;bob&#x27;, &#x27;Goodbye, cruel world.&#x27;)
create_tweet(3, &#x27;charlie&#x27;, &#x27;This is a tweet.&#x27;)
create_tweet(4, &#x27;alice&#x27;, &#x27;Another tweet!&#x27;)
create_tweet(5, &#x27;bob&#x27;, &#x27;Yet another tweet.&#x27;)
</code></pre><p id="8dc2edf2-1411-47f7-874c-042145da2e47" class="">We now have some users and tweets in our data model. We can view the public timeline by using the <code>lrange</code> command to retrieve the last 10 tweets:</p><pre id="205b3900-8613-47f8-937a-520040c8c1d5" class="code code-wrap"style="overflow-x:auto;"><code># View the public timeline
public_timeline = r.lrange(&#x27;public_timeline&#x27;, 0, 10)
for tweet_id in public_timeline:
    tweet = r.hgetall(f&#x27;tweet:{tweet_id}&#x27;)
    print(f&#x27;{tweet[b&quot;user_id&quot;].decode()} tweeted &quot;{tweet[b&quot;text&quot;].decode()}&quot;&#x27;)
</code></pre><p id="af2c97c0-ba16-4d45-b2d1-11aa9c0172fd" class="">This should output:</p><pre id="f49bd8bc-ece5-424c-b4e8-1c4e5601212d" class="code code-wrap"style="overflow-x:auto;"><code>bob tweeted &quot;Yet another tweet.&quot;
alice tweeted &quot;Another tweet!&quot;
charlie tweeted &quot;This is a tweet.&quot;
bob tweeted &quot;Goodbye, cruel world.&quot;
alice tweeted &quot;Hello world!&quot;
</code></pre><h2 id="00e409ab-f115-4044-ad0b-c09a652497a8" class="">Part 2: Simulating the fan-out-on-write approach</h2><p id="7b71fa2b-374b-4274-a16a-1e7d72c269fe" class="">Now that we have some data in our model, let&#x27;s simulate the fan-out-on-write approach used by Twitter to update each follower&#x27;s timeline when a user posts a new tweet. We will create a function <code>post_tweet</code> that takes a user ID and tweet text and posts the tweet to the user&#x27;s timeline and the timelines of all of their followers.</p><pre id="9eaf69c0-888b-40b7-91b6-836a747ff9dc" class="code code-wrap"style="overflow-x:auto;"><code># Define a function to post a tweet
def post_tweet(user_id, tweet_text):
    # Create the tweet
    tweet_id = r.incr(&#x27;tweet_id_counter&#x27;)
    create_tweet(tweet_id, user_id, tweet_text)

    # Add the tweet to the timelines of all of the user&#x27;s followers
    followers = r.smembers(f&#x27;followers:{user_id}&#x27;)
    for follower_id in followers:
        r.lpush(f&#x27;user_timeline:{follower_id}&#x27;, tweet_id)
</code></pre><p id="5f387302-b74a-4547-9013-9d9ceec313de" class="">Here, we use the Redis <code>incr</code> command to generate a unique ID for the tweet, and then we call <code>create_tweet</code> to create the tweet and add it to the user&#x27;s timeline and the public timeline. Next, we retrieve the user&#x27;s followers using the Redis <code>smembers</code> command and then use <code>lpush</code> to add the tweet to the timelines of each follower.</p><p id="8f5e69f0-ff37-4988-bf49-cabc5ab2fda4" class="">Now, let&#x27;s create some followers and test our <code>post_tweet</code> function:</p><pre id="24595552-1457-4beb-84a8-b3dd9e7ecd6c" class="code code-wrap"style="overflow-x:auto;"><code># Make bob follow alice and charlie
r.sadd(&#x27;followers:bob&#x27;, &#x27;alice&#x27;, &#x27;charlie&#x27;)

# Post a tweet as alice
post_tweet(&#x27;alice&#x27;, &#x27;This is my first tweet!&#x27;)

# View bob&#x27;s timeline
bob_timeline = r.lrange(&#x27;user_timeline:bob&#x27;, 0, 10)
for tweet_id in bob_timeline:
    tweet = r.hgetall(f&#x27;tweet:{tweet_id}&#x27;)
    print(f&#x27;{tweet[b&quot;user_id&quot;].decode()} tweeted &quot;{tweet[b&quot;text&quot;].decode()}&quot;&#x27;)
</code></pre><p id="dc2b46eb-a854-4d76-84d4-a5d400415a86" class="">This should output:</p><pre id="6ba69d99-5c2f-445d-80bc-0ea81c3d179c" class="code code-wrap"style="overflow-x:auto;"><code>charlie tweeted &quot;This is a tweet.&quot;
alice tweeted &quot;Another tweet!&quot;
alice tweeted &quot;Hello world!&quot;
alice tweeted &quot;This is my first tweet!&quot;
</code></pre><p id="6ae26230-920a-4b96-acf7-dd8ff35a8c48" class="">We can see that Bob&#x27;s timeline now includes Alice&#x27;s tweet as well as the tweets from the users he is following.</p><h2 id="adafa996-7c12-448c-a999-4accc4ecea70" class="">Part 3: Handling scalability challenges</h2><p id="faf8bf83-6433-45cd-b9cf-83955c916859" class="">One of the scalability challenges with the fan-out-on-write approach is that it can become very expensive to update the timelines of users with large numbers of followers. To handle this challenge, Twitter uses a fan-out-on-read approach, where the timeline is only updated when a user reads their timeline.</p><p id="c3227ae5-db4d-489d-afbf-7c87adc4a119" class="">Let&#x27;s modify our data model to simulate the fan-out-on-read approach. We will create a function <code>get_user_timeline</code> that takes a user ID and retrieves their timeline. The function will first check if the timeline has been updated since the last time the user accessed it. If it has, it will update the timeline by fetching the tweets from the users they follow and sorting them by timestamp.</p><pre id="10fc5ecd-946c-46a8-9555-e16a6d9d9436" class="code code-wrap"style="overflow-x:auto;"><code>import time

# Define a function to get a user&#x27;s timeline
def get_user_timeline(user_id):
    # Get the last time the user accessed their timeline
    last_access_time = r.get(f&#x27;last_access_time:{user_id}&#x27;)
    if not last_access_time:
        last_access_time = 0
    else:
        last_access_time = float(last_access_time)

    # Get the latest tweets from the users the user follows
    followers = r.smembers(f&#x27;followers:{user_id}&#x27;)
    latest_tweets = []
    for follower_id in followers:
        # Get the last time the follower posted a tweet
        last_tweet_time = r.get(f&#x27;last_tweet_time:{follower_id}&#x27;)
        if not last_tweet_time:
            last_tweet_time = 0
        else:
            last_tweet_time = float(last_tweet_time)

        # If the follower has posted a tweet since the user last accessed
        # their timeline, get their latest tweets
        if last_tweet_time &gt; last_access_time:
            tweets = r.lrange(f&#x27;user_timeline:{follower_id}&#x27;, 0, 10)
            for tweet_id in tweets:
                latest_tweets.append((int(tweet_id), float(r.hget(f&#x27;tweet:{tweet_id}&#x27;, &#x27;timestamp&#x27;))))

# If the timeline has not been updated, return the cached timeline
if len(latest_tweets) == 0:
    timeline = r.lrange(f&#x27;user_timeline:{user_id}&#x27;, 0, 10)
# Otherwise, update the timeline by fetching the latest tweets and sorting them by timestamp
else:
    latest_tweets = sorted(latest_tweets, key=lambda x: x[1], reverse=True)
    tweet_ids = [x[0] for x in latest_tweets]
    timeline = r.lrange(f&#x27;timeline:{user_id}&#x27;, 0, 10)
    timeline.extend(r.hmget(&#x27;tweet&#x27;, *tweet_ids))

    # Cache the updated timeline and access time
    r.ltrim(f&#x27;user_timeline:{user_id}&#x27;, 0, 0)
    r.rpush(f&#x27;user_timeline:{user_id}&#x27;, *tweet_ids)
    r.set(f&#x27;last_access_time:{user_id}&#x27;, time.time())

# Return the timeline
return [r.hgetall(f&#x27;tweet:{tweet_id}&#x27;) for tweet_id in timeline]
</code></pre><p id="894a52fe-87da-4258-9038-2ccc6e694c1d" class="">Here, we use the Redis `get` command to retrieve the last time the user accessed their timeline, and then we iterate through their followers to check if any of them have posted new tweets since the last access time. If so, we fetch their latest tweets and cache them in the user&#x27;s timeline. Finally, we return the user&#x27;s timeline.

Now, let&#x27;s test our `get_user_timeline` function:</p><pre id="15504480-40d2-4f9a-b05b-c19af6470abc" class="code code-wrap"style="overflow-x:auto;"><code># Get bob&#x27;s timeline
bob_timeline = get_user_timeline(&#x27;bob&#x27;)
for tweet in bob_timeline:
    print(f&#x27;{tweet[b&quot;user_id&quot;].decode()} tweeted &quot;{tweet[b&quot;text&quot;].decode()}&quot;&#x27;)
</code></pre><p id="4279ef37-c3d9-4d81-bb08-ba1aaa9305a9" class="">This should output the same timeline as before:</p><pre id="ede359ea-332a-4579-b48f-21bc14d6fd27" class="code code-wrap"style="overflow-x:auto;"><code>charlie tweeted &quot;This is a tweet.&quot;
alice tweeted &quot;Another tweet!&quot;
alice tweeted &quot;Hello world!&quot;
alice tweeted &quot;This is my first tweet!&quot;
</code></pre><h2 id="9bcd9f4f-0b9d-4ba9-aba5-7afe77e5698b" class="">Conclusion</h2><p id="bf75852f-f811-4b78-b865-1cfd43da7451" class="">In this blog post, we created a simple data model to simulate a social network using Redis. We started by creating functions to add users and follow other users, and then we implemented a fan-out-on-write approach to update the timelines of users with new tweets. We then modified our data model to simulate a fan-out-on-read approach, where timelines are only updated when a user reads them. This approach can help to reduce the cost of updating the timelines of users with large numbers of followers.</p><p id="24523d48-9a2b-46fa-9ad8-7b287781ba59" class="">To learn more about designing data-intensive applications, we recommend reading the book &quot;Designing Data-Intensive Applications&quot; by Martin Kleppmann. The book covers a wide range of topics related to designing and building scalable, distributed systems, including data modeling, storage systems, messaging systems, and more. The book also includes many real-world examples and case studies to help you apply the concepts in practice.</p><p id="17cd5cd3-0803-49d4-b440-89393baf3a73" class="">
</p></div></article></body></html>